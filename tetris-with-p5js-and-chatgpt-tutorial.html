<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to make Tetris with p5.js and ChatGPT with a focus on Gherkin Syntax and Behavior Driven Development
        (BDD) flavor of Test Driven Development (TDD)</title>
        
        
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js"></script>
    <style>
        .text-white {
            color: #fff;
        }

        /* Additional CSS */
        .menu-button {
            display: none;
        }

        @media (min-width: 768px) {
            .desktop-menu {
                display: none;
            }

            .menu-button {
                display: block;
            }

            /* Adjust layout for tablet landscape/desktop */
            .layout {
                display: flex;
                flex-direction: row;
            }

            .menu-sections {
                flex-basis: 30%;
                position: fixed;
                max-width: 300px
            }

            .content-viewer {
                min-width: 100px;
            }

            .content-viewer {
                flex-basis: 70%;
                margin-left: 1rem;
            }
            #contentViewerList {
                margin-top: calc(50% - 33%);
            }

            #contentViewerList {
                margin-top: calc(50% - 33%);
            }

            .content-viewer-outer {
                max-height: 100vh;
                overflow-y: auto;
                min-width: calc( 100vw - 400px);
            }

            /* aka #contentViewerList */
            .content-viewer-list {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                grid-auto-rows: minmax(100px, auto);
                grid-gap: 1rem;
                grid-auto-flow: dense;
                align-items: start;
            }
        }

        @media (max-width: 767px) {
            .mobile-menu {
                display: none;
            }
        }

        /* Dark theme styling */
        body {
            background-color: #111827;
            /* Tailwind color: bg-gray-900 */
        }

        .menu-section {
            background-color: #4B5563;
            /* Tailwind color: bg-gray-600 */
            color: #F9FAFB;
            /* Tailwind color: text-gray-100 */
        }

        .menu-section:hover {
            background-color: #6B7280;
            /* Tailwind color: bg-gray-500 */
        }

        .active-section {
            background-color: #6D28D9;
            /* Tailwind color: bg-purple-700 */
        }

        .title {
            color: #F9FAFB;
            /* Tailwind color: text-gray-100 */
        }

        .mobile-menu-button {
            color: #F9FAFB;
            /* Tailwind color: text-gray-100 */
        }

        .mobile-menu-close {
            color: #EF4444;
            /* Tailwind color: text-red-500 */
        }

        /* Content Viewer */
        .content-viewer {
            background-color: #1F2937;
            /* Tailwind color: bg-gray-800 */
            color: #F9FAFB;
            /* Tailwind color: text-gray-100 */
            padding: 2rem;
            margin-top: 1rem;
            border-radius: 0.5rem;
        }

        .header-image-wrapper {
            cursor: pointer;

            h2 {
                text-align: center;
                padding: 20px;
            }

            border-top: 1px solid #fff;
            border-right: 1px solid #666;
            border-bottom: 1px solid #333;
            border-left: 1px solid #666;
            border-radius: 0.5rem;

            img {
                border-radius: 0.5rem;
                opacity: 0.1;
                transition: all 0.3s ease;
                filter: blur(5px);

            }
        }

        .content-viewer:hover .header-image-wrapper {
            img {
                opacity: 0.5;
                filter: blur(0px);

            }
        }

        :root {
            --max-columns: 4;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(var(--max-columns), 1fr);
        }

        .content-viewer {
            transition: all 0.3s ease;
        }

        body:not(.force-to-one-col) .content-viewer {
            transition: all 1s ease;
            max-height: 100px;
            overflow: hidden;
        }

        body.force-to-one-col .grid-container {
            display: flex !important;
            flex-direction: column !important;
            flex-wrap: wrap !important;
        }

        body.force-to-one-col .content-viewer {
            /* min-width: calc(100vw - 800px) !important;
            max-width: calc(100vw - 800px) !important;
            flex-basis: calc(100vw - 800px) !important;
            width: calc(100vw - 800px) !important; */
        }
        .bg-midnightblue {
            background-color: #191970;
        }

        .text-palegoldenrod {
            color: #eee8aa;
        }
        .credits {
            max-height: none !important;
        }
        .credits a {
            font-weight: bold;
            text-decoration: underline;

        }
        :root {
            --bg-image-in: url('./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp');
            --bg-image-out: url('./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp');
            --bg-image: var(--bg-image-in);
        }

        .bg-img {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: var(--bg-image);
            background-size: cover;
            background-position: center center;
            transition: opacity 1s ease, transform 1s ease;
            /* transform: translateY(-100px); */
            opacity: 0.1;
            z-index: -1;
        }

        .bg-img::before,
        .bg-img::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp');
            background-size: cover;
            background-position: center center;
            transition: opacity 1s ease, transform 1s ease;
        }

        .bg-img::before {
            background-image: var(--bg-image-out);
            opacity: 1;
            animation: fadeOut 0.3s ease forwards;
        }

        .bg-img::after {
            background-image: var(--bg-image-in);
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
            z-index: -1;
        }

        .bg-img.swap::before {
            animation-name: fadeOutUp;
        }

        .bg-img.swap::after {
            animation-name: fadeInUp;
        }

        :root {
            --translate-amount: 100px;
            --neg-translate-amount: calc(-1 * var(--translate-amount));
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(var(--translate-amount)); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(calc(-1 * var(--translate-amount))); }
        }

        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(var(--translate-amount)); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOutUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(var(--neg-translate-amount)); }
        }

        .bg-img.show::before {
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: translateY(-10px);
            z-index: -1;
        } 
        .menu-section#nav-intro::before {
            background-image: url('/res/DALL·E 2023-12-26 15.57.30 - A visually compelling blog header image, designed in dark mode, that encapsulates the themes of artificial intelligence, programming, and Tetris, with.png');
        }

        .bg-img.show::after {
            opacity: 1;
        }

        .timeline-wrapper {
            /* position: absolute; */
            height: 390px;
            width: 2px;
        }

        .timeline-bg {
            /* top: 12px; */
            top: -8px;
            width: 10px;
            height: 390px;
            background-color: #ddd;
            position: absolute;
            z-index: 1;
        }

        .timeline_covered {
            top: -8px;
            width: 10px;
            height: 25%;
            z-index: 2;
            background-color: #6D28D9;
            position: absolute;
            transition: height 0.3s ease;
        }

        .timeline-circle {
            z-index: 3;
            position: relative;
            height: 25px;
            width: 25px;
            /* margin-top: 10px; */
            border-radius: 50%;
            background-color: #ddd;
            /* margin-bottom: 10px; */
            /* top: 6.25px; */
            margin: 23.5px 0;
            left: -8px;
            top: -20px;
            box-sizing: border-box;
            transition: background-color 0.15s ease 0.15s;
        }

        .timeline-circle.visited {
            background-color: #6D28D9;
        }

        /* at DESKTOP resolution, force #contentViewerList to flex row with 3 columns */
        @media (min-width: 768px) {
            #contentViewerList {
                overflow-x: hidden;
                /* display: flex;
                flex-direction: row;
                flex-wrap: wrap; nowrap; */
                /* justify-content: flex-start; */
                /* align-items: stretch; */
                /* align-content: stretch; */
            }

            #contentViewerList .content-viewer {
                /*flex-basis: calc(33% - 50px);*/
            }
        }
        .header-image-wrapper {
            cursor: pointer;
            h2 {
                text-align: center;
                padding: 20px;
            }
            border-top: 1px solid #fff;
            border-right: 1px solid #666;
            border-bottom: 1px solid #333;
            border-left: 1px solid #666;
            border-radius: 0.5rem;
            img {
                border-radius: 0.5rem;
                opacity: 0.1;
                transition: all 0.3s ease;
                filter: blur(5px);
                
            }
        }
        .content-viewer {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.2), 0 1px 2px 0 rgba(0, 0, 0, 0.12);
        }
        .content-viewer:hover {
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.32), 0 2px 10px 0 rgba(0, 0, 0, 0.24);
        }
        .content-viewer:hover .header-image-wrapper {
            img {
                opacity: 0.5;
                filter: blur(0px);
                
            }
        }

        :root {
            --max-columns: 4;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(var(--max-columns), 1fr);
        }
        .content-viewer {
            transition: all 0.3s ease;
        }
        body:not(.force-to-one-col) .content-viewer {            
            transition: max-height 0.3s ease;
            max-height: 100px;
            overflow: hidden;
        }
        body.force-to-one-col .grid-container {
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
        }
        body.force-to-one-col .content-viewer {
            width: 100% !important;
            flex-basis: 100% !important;
        }
    </style>
</head>

<body class="font-sans">
<div class="bg-img show"></div>
    <!-- Combined Layout -->
    <div class="layout">
        <!-- Menu Sections -->
        <div class="menu-sections flex flex-col items-start p-8">
            <div class="text-2xl font-bold mb-4 title">building tetris with p5.js and chatGPT</div>
            <div class="text-l font-semibold mb-2 text-white">A step by step guide using Gherkin Behavior Driven
                Development focused prompting</div>
            
            <div class="flex flex-row flex-wrap">
                <div class="flex flex-row w-full">
                    <button onclick="switchContent('results');"
                        class="bg-green-500 hover:bg-green-700 text-white font-bold p-4 m-4 rounded w-1/2">Play</button>
                    <button onclick="scrollToPreviousSection();"
                        class="w-1/2 bg-red-500 hover:bg-red-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                    <button onclick="scrollToNextSection();"
                        class="w-1/2 bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                </div>
                <div class="relative">

                    <div class="timeline-wrapper relative block">
                        <div class="timeline-bg"></div>
                        <div class="timeline_covered"></div>
                        <div class="timeline">
                            <div class="timeline-inner relative block">
                                <div id="timeline-intro" class="timeline-circle visited"></div>
                                <div id="timeline-terms" class="timeline-circle"></div>
                                <div id="timeline-building" class="timeline-circle"></div>
                                <div id="timeline-tetrominos" class="timeline-circle"></div>
                                <div id="timeline-game" class="timeline-circle"></div>
                                <div id="timeline-controls" class="timeline-circle"></div>
                                <div id="timeline-mobile" class="timeline-circle"></div>
                                <div id="timeline-results" class="timeline-circle"></div>
                                <div id="timeline-future" class="timeline-circle"></div>
                                <div id="timeline-credits" class="timeline-circle"></div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-2 pl-8 absolute" style="left: 100%; right: 0; top: 0;">
                        <div id="nav-intro" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('intro')">intro</div>
                        <div id="nav-terms" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('terms')">terms & definitions</div>
                        <div id="nav-building" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('building')">1. building the grid</div>
                        <div id="nav-tetrominos" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('tetrominos')">2. tetrominos</div>
                        <div id="nav-game" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('game')">3. game loop</div>
                        <div id="nav-controls" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('controls')">4. controls</div>
                        <div id="nav-mobile" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('mobile')">5. mobile considerations</div>
                        <div id="nav-final-result" class="bg-green menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('results')">7. final result</div>
                        <div id="nav-future" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('future')">6. future
                            work</div>
                        <div id="nav-credits" class="menu-section p-2 w-64 rounded cursor-pointer"
                            onclick="switchContent('credits')">credits</div>
                    </div>
                </div>
                </div>
            </div>
            
        </div>

        <!-- Content Viewer List (scroll container) -->

        <div class="content-viewer-outer md:ml-[400px]">
            <div id="contentViewerList" class="content-viewer-list pr-12 mr-12 grid-container">
                <div class="content-viewer w-full rounded-t-lg flex flex-row p-0">
                    <div id="intro" class="content rounded-t-lg overflow-hidden flex flex-col">
                        <div
                            class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/DALL·E 2023-12-26 15.57.30 - A visually compelling blog header image, designed in dark mode, that encapsulates the themes of artificial intelligence, programming, and Tetris, with.png"
                                alt="Background Image" class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Introduction</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <div class="relative block">
                                <p class="mb-4">Welcome to this tutorial on building Tetris with p5.js and chatGPT. In
                                    this
                                    tutorial, we will guide you step by step on how to create your own version of the
                                    classic game Tetris using the p5.js library and chatGPT for behavior driven
                                    development.
                                </p>
                                <p class="mb-4">Before we start, make sure you have a basic understanding of JavaScript
                                    and
                                    HTML. Knowledge in p5.js and chatGPT is not required as we will cover them in this
                                    tutorial.</p>
                                <p class="mb-4">Let's get started!</p>
                            </div>
                        </div>
                        <div class="flex flex-row justify-between">
                            <button onclick="switchContent('results');"
                                class="bg-green-500 hover:bg-green-700 text-white font-bold p-4 m-4 rounded w-1/2">Play</button>
                            <button
                                onclick="let nextElement = this.parentElement.parentElement.parentElement.nextElementSibling; nextElement.scrollIntoView({behavior: 'smooth'}); setTimeout(() => { window.scrollBy(0, -100); }, 500);"
                                class="w-1/2 bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                        </div>
                    </div>
                </div>
                <div class="content-viewer rounded-t-lg flex flex-row p-0" data-section-key="terms">
                    <div id="terms" class="content rounded-t-lg overflow-hidden flex-col">
                        <div
                            class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/9800c48a-6a59-4caa-adbc-864eec10b6de.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Terms and Definitions</h2>
                            </div>
                        </div>
                        <div class="p-4 flex">

                            <div class="parent flex flex-wrap">
                                <div class="child w-full md:w-1/2 p-4">
                                    <h3 class="text-xl font-bold mb-2">Test-Driven Development (TDD)</h3>
                                    <p class="mb-4">TDD is a software development process where you write a test before
                                        you
                                        write your code, and then write the code to pass the test.</p>
                                    <h3 class="text-xl font-bold mb-2">Behavior-Driven Development (BDD)</h3>
                                    <p class="mb-4">BDD is a software development process that encourages collaboration
                                        between
                                        developers, QA and non-technical or business participants in a software project.
                                    </p>
                                    <h3 class="text-xl font-bold mb-2">Gherkin</h3>
                                    <p class="mb-4">Gherkin is a language designed to be easy to learn by
                                        non-programmers
                                        and
                                        yet structured enough to allow concise description of examples to illustrate
                                        business
                                        rules in most real-world domains.</p>
                                    <h3 class="text-xl font-bold mb-2">Cucumber</h3>
                                    <p class="mb-4">Cucumber is a tool that supports BDD. It runs automated acceptance
                                        tests
                                        written in a behavior-driven development (BDD) style.</p>
                                </div>
                                <div class="child w-full md:w-1/2 p-4">
                                    <h3 class="text-xl font-bold mb-2">Tetris</h3>
                                    <p class="mb-4">Tetris is a popular video game that involves stacking tetrominoes to
                                        clear
                                        lines.</p>
                                    <h3 class="text-xl font-bold mb-2">ChatGPT</h3>
                                    <p class="mb-4">ChatGPT is a language model developed by OpenAI. It's capable of
                                        generating
                                        human-like text based on the input it's given.</p>
                                    <h3 class="text-xl font-bold mb-2">Agent</h3>
                                    <p class="mb-4">In the context of AI, an agent is anything that can perceive its
                                        environment
                                        through sensors and acts upon that environment through effectors.</p>
                                    <h3 class="text-xl font-bold mb-2">Deep Learning, Machine Learning, Deep Neural
                                        Networks,
                                        Transformers, GPT</h3>
                                    <p class="mb-4">These are all terms related to AI. Deep Learning is a subset of
                                        Machine
                                        Learning that uses neural networks with many layers (hence "deep"). Transformers
                                        are
                                        a
                                        type of model used in machine learning. GPT (Generative Pretrained Transformer)
                                        is a
                                        type of transformer model developed by OpenAI.</p>
                                </div>
                            </div>


                        </div>
                        <button
                            onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <button
                            onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                    </div>
                </div>
                <div class="content-viewer rounded-t-lg flex flex-row p-0" data-section-key="building">
                    <div id="building" class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class=" header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/6a6cf0d2-7a1b-4cbd-b6ec-004aa01fb20b.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Building the Grid</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">Building the Grid</h2>

                            <div class="clickable bg-blue-900 text-white p-4 rounded-lg mb-4 cursor-pointer" onclick="event.preventDefault(); this.querySelectorAll('.hidden, .hidden-decision').forEach((e)=>{e.classList.remove('hidden')});this.querySelector('.hideonreveal').classList.add('hidden');">
                                <h3 class="font-bold text-xl">Guess What's Next!</h3>
                                <p>What's the first decision we have to make about our game?</p>
                                <strong class="hideonreveal">Click to reveal the answer</strong>
                                <p class="hidden">How about we decide if we want to make a 2D, 3D or 2.5D game!</p>
                            </div>
                            <div class="my-4 rounded-lg p-4 border-2 border-gray-200 hidden hidden-decision">
                                <h3 class="text-xl font-bold mb-2">Game Dimension Decision</h3>
                                <p class="mb-4">This is a critical decision point in our game development process. The dimension we choose (2D, 3D, or 2.5D) will significantly impact the complexity of our game and the player's experience. Let's make a well-informed decision!</p>
                                <label for="gameDimension" class="text-xl font-bold mb-2">Choose the game dimension:</label>
                                <input type="range" id="gameDimension" name="gameDimension" min="1" max="3" value="2" class="slider w-full h-6 rounded-full">
                                <div class="flex justify-between text-sm font-bold mt-2">
                                    <span>2D</span>
                                    <span>2.5D</span>
                                    <span>3D</span>
                                </div>
                            </div>

                            <div class="bg-yellow-900 text-white p-4 rounded-lg mb-4 flex flex-row justify-between">
                                <div>
                                    <h3 class="font-bold text-xl">Given</h3>
                                    <p>What's the first <strong>Given</strong> we can think of as a user?</p>
                                </div>
                                <input type="text" class="text-2xl w-full bg-black text-yellow p-4 m-4 rounded-xl" placeholder="I start a new game...">
                            </div>
                            <div class="bg-purple-900 text-white p-4 rounded-lg mb-4 flex flex-row justify-between">
                                <div>
                                    <h3 class="font-bold text-xl">When</h3>
                                    <p>What's the first <strong>When</strong> we can think of as a user?</p>
                                </div>
                                <input type="text" class="text-2xl w-full bg-black text-purple p-4 m-4 rounded-xl" placeholder="I wait a few frames...">
                            </div>
                            <div class="bg-orange-900 text-white p-4 rounded-lg mb-4 flex flex-row justify-between">
                                <div>
                                    <h3 class="font-bold text-xl">Then</h3>
                                    <p>What's the first <strong>Then</strong> we can think of as a user?</p>
                                </div>
                                <input type="text" class="text-2xl w-full bg-black text-orange p-4 m-4 rounded-xl" placeholder="I see the first piece falling into the top row...">
                            </div>

                            <p class="mb-4">In this section, we will discuss how to build the grid for our Tetris game using
                                p5.js.
                                The grid is a crucial component of the game as it is where the Tetris blocks will be placed
                                and
                                moved around.</p>
                            <p class="mb-4">We will be using a 2D array to represent our grid. Each cell in the array will
                                represent
                                a cell in the Tetris grid. We will initialize all cells to be empty at the start of the
                                game.
                            </p>
                            <p class="mb-4">We will also need to create a function to draw the grid on the screen. This
                                function
                                will loop through each cell in our 2D array and draw a square at the corresponding location
                                on
                                the
                                screen.</p>
                            <p class="mb-4">Finally, we will need to create a function to update the grid. This function
                                will be
                                called whenever a Tetris block is moved or rotated. It will update the 2D array to reflect
                                the
                                new
                                state of the grid.</p>
                            <form id="gridForm" class="flex justify-left items-left mb-16">
                                <div class="mr-4">
                                    <label for="rows" class="text-white">Rows:</label><br>
                                    <input type="number" id="rows" name="rows" value="20" onchange="updateGrid()"
                                        class="bg-black text-white text-2xl w-16">
                                </div>
                                <div>
                                    <label for="columns" class="text-white">Columns:</label><br>
                                    <input type="number" id="columns" name="columns" value="10" onchange="updateGrid()"
                                        class="bg-black text-white text-2xl w-16">
                                </div>
                                <div class="flex items-end mt-4 ml-4">
                                    <button onclick="resetGrid()"
                                        class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Reset</button>
                                </div>
                            </form>

                            <h3 class="text-xl font-bold mb-2">Prompt Output:</h3>
                            <p class="text-gray-500 text-sm mb-2">Click on the prompt to copy it to clipboard</p>
                            <button class="copyButton" onclick="copyToClipboard('building')"
                                class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                                &#128203; Copy Prompt
                            </button>

                            <div id="promptOutput-building" class="clickable" onclick="copyToClipboard('building')"
                                class="cursor-pointer p-2 rounded border border-gray-300 bg-black text-white"
                                style="font-family: 'Courier New', monospace; white-space: pre-wrap;">Prompt will be
                                displayed
                                here...</div>
                        </div>
                        <button
                            onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <button
                            onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                    </div>
                </div>
                <div id="tetrominos" class="content-viewer rounded-t-lg flex flex-row p-0">
                    <div class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/9f57e694-d11b-4721-9076-10a647235738.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Tetrominos</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">Section 2. Tetrominos</h2>
                            <p class="mb-4">In this section, we will discuss how to create the Tetrominos for our Tetris game
                                using
                                p5.js. The Tetrominos are the shapes that will be falling from the top of the screen. There are
                                seven different Tetrominos in total: I, J, L, O, S, T, and Z.</p>
                            <p class="mb-4">We will be using a 2D array to represent each Tetromino. Each cell in the array will
                                represent a cell in the Tetromino. We will initialize all cells to be empty at the start of the
                                game.</p>
                            <p class="mb-4">We will also need to create a function to draw the Tetromino on the screen. This
                                function will loop through each cell in our 2D array and draw a square at the corresponding
                                location
                                on the screen.</p>
                            <p class="mb-4">Finally, we will need to create a function to update the Tetromino. This function
                                will
                                be called whenever a Tetromino is moved or rotated. It will update the 2D array to reflect the
                                new
                                state of the Tetromino.</p>
                            <h3 class="text-xl font-bold mb-2">Prompt Output:</h3>
                            <p class="text-gray-500 text-sm mb-2">Click on the prompt to copy it to clipboard</p>
                            <button class="copyButton" onclick="copyToClipboard('tetrominos')"
                                class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                                &#128203; Copy Prompt
                            </button>
        
                            <div id="promptOutput-tetrominos" class="clickable" onclick="copyToClipboard('tetrominos')"
                                class="cursor-pointer p-2 rounded border border-gray-300 bg-black text-white"
                                style="font-family: 'Courier New', monospace; white-space: pre-wrap;">Prompt will be displayed
                                here...</div>
                            <ol>
                                <li>
                                    <p>Define Tetrominos: Create 2D arrays for each of the seven Tetromino shapes (I, J, L, O,
                                        S, T,
                                        and Z). Each cell in these arrays represents a block in the Tetromino.</p>
                                    <pre><code class="language-javascript">const I = [[1, 1, 1, 1]], J = [[1, 0, 0], [1, 1, 1]], L = [[0, 0, 1], [1, 1, 1]], O = [[1, 1], [1, 1]], S = [[0, 1, 1], [1, 1, 0]], T = [[0, 1, 0], [1, 1, 1]], Z = [[1, 1, 0], [0, 1, 1]];</code></pre>
                                </li>
                                <li>
                                    <p>Drawing Tetrominos: Develop a function to draw a Tetromino on the screen. This function
                                        should loop through each cell in the Tetromino's 2D array and draw a square at the
                                        corresponding location.</p>
                                    <pre><code class="language-javascript">function drawTetromino(tetromino, x, y, size) {
            for (let i = 0; i < tetromino.length; i++) {
            for (let j = 0; j < tetromino[i].length; j++) {
                if (tetromino[i][j] === 1) {
                rect(x + j * size, y + i * size, size, size);
                }
            }
            }
        }
        </code></pre>
                                </li>
                                <li>
                                    <p>Updating Tetrominos: Implement a function to update the position and rotation of a
                                        Tetromino.
                                        This function should modify the Tetromino's 2D array to reflect its new state after
                                        movement
                                        or rotation.</p>
                                    <pre><code class="language-javascript">function updateTetromino(tetromino, direction) {
            // Rotate or move the tetromino based on the direction
            // This is a placeholder and needs to be implemented based on the game's logic
        }
        </code></pre>
                                </li>
                            </ol>
                            <p>Tetrominos are a great usecase for "Scenario Outlines" in Gherkin BDD. We can easily define a map of valid rotations, for example, and loop through them all, reusing the same logic to validate all 7 * 4 possibilities;</p>
                            <p>ChatGPT Says: Don't Forget... <span></span></p>
                            <p class="mb-2">Remember to always test your game thoroughly. Make sure all Tetromino rotations and movements work as expected and the game ends when it should.</p>
                        </div>
        
                        <button
                            onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">
                            Next
                        </button>
                    </div>
                </div>

                <div id="game" class="content-viewer rounded-t-lg flex flex-row p-0">
                    <div class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px]
                        max-h-[400px]">
                            <img src="./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Game Loop</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">Game Loop</h2>
                            <p class="mb-4">In this section, we will discuss how to create the game loop for our Tetris game using
                                p5.js. The game loop is responsible for updating the state of the game and drawing it on the screen.
                            </p>
                            <p class="mb-4">We will need to create a function to update the state of the game. This function will be
                                called every frame and will be responsible for updating the position of the Tetromino and checking
                                if it has collided with any other Tetrominos.</p>
                            <p class="mb-4">We will also need to create a function to draw the state of the game on the screen. This
                                function will be called every frame and will be responsible for drawing the Tetromino and the grid.
                            </p>
                            <p class="mb-4">Finally, we will need to create a function to handle user input. This function will be
                                called whenever the user presses a key on the keyboard. It will be responsible for moving the
                                Tetromino and rotating it.</p>
                        </div>
                        <button
                            onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <button onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                    </div>
                </div>
                <div class="content-viewer rounded-t-lg flex flex-row p-0">
                    <div id="controls" class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class=" header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/DALL·E 2023-12-26 16.45.30 - Create a pixel art image showing a dynamic scene of game development, where workers handle keyboard and touch inputs, including giant finger and keybo.png"
                            alt="Background Image" class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Controls</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">Controls</h2>
                            <p class="mb-4">In this section, we will discuss how to create the controls for our Tetris game using
                                p5.js. The controls are responsible for moving the Tetromino and rotating it.</p>
                            <p class="mb-4">We will need to create a function to handle user input. This function will be called
                                whenever the user presses a key on the keyboard. It will be responsible for moving the Tetromino and
                                rotating it.</p>
                            <p class="mb-4">We will also need to create a function to check if the Tetromino has collided with any
                                other Tetrominos. This function will be called whenever the Tetromino is moved or rotated. It will
                                be responsible for checking if the Tetromino has collided with any other Tetrominos.</p>
                            <p class="mb-4">Finally, we will need to create a function to update the state of the game. This
                                function will be called every frame and will be responsible for updating the position of the
                                Tetromino and checking if it has collided with any other Tetrominos.</p>
                        </div>
                        <button onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <button onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                    </div>
                </div>

                <div class="content-viewer rounded-t-lg flex flex-row p-0">
                    <div id="mobile" class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Mobile Considerations</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">Mobile Considerations</h2>
                            <p class="mb-4">In this section, we will discuss how to make our Tetris game touch responsive using
                                p5.js. The game will be playable on both desktop and mobile devices.</p>
                            <p class="mb-4">We will need to create a function to handle user input. This function will be called
                                whenever the user presses a key on the keyboard or touches the screen. It will be responsible for
                                moving the Tetromino and rotating it.</p>
                            <p class="mb-4">We will also need to create a function to check if the Tetromino has collided with any
                                other Tetrominos. This function will be called whenever the Tetromino is moved or rotated. It will
                                be responsible for checking if the Tetromino has collided with any other Tetrominos.</p>
                            <p class="mb-4">Finally, we will need to create a function to update the state of the game. This
                                function will be called every frame and will be responsible for updating the position of the
                                Tetromino and checking if it has collided with any other Tetrominos.</p>
                        </div>
                        <button onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <button onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                    </div>
                </div>

                <div class="content-viewer rounded-t-lg flex flex-row p-0">
                    <div id="results" class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">View Final Results</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">View Final Results</h2>
                            <p class="mb-4">In this section, you can view the final results of your Tetris game. You can see how the
                                game looks and behaves after implementing all the features discussed in the tutorial.</p>
                            <p class="mb-4">You can interact with the game, play it, and test its features. This will give you a better
                                understanding of how the different parts of the game work together.</p>
                            <p class="mb-4">Enjoy playing your Tetris game!</p>
                        </div>
                        <button onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <button onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button>
                    </div>
                </div>

                <div class="content-viewer rounded-t-lg flex flex-row p-0">
                    <div id="future" class="content rounded-t-lg overflow-hidden flex-col"">
                        <div class="header-image-wrapper relative aspect-w-16 aspect-h-9 p-0 min-h-[100px] max-h-[400px]">
                            <img src="./res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp" alt="Background Image"
                                class="absolute inset-0 w-full h-full object-cover ">
                            <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center">
                                <h2 class="text-2xl font-bold mb-4">Future Work</h2>
                            </div>
                        </div>
                        <div class="p-4">
                            <h2 class="text-2xl font-bold mb-4">Future Work</h2>
                            <p class="mb-4">In this section, we will discuss some ideas for future work on our Tetris game using
                                p5.js. The game is currently playable on both desktop and mobile devices.</p>
                            <p class="mb-4">We could add more Tetrominos to the game. There are seven different Tetrominos in total:
                                I, J, L, O, S, T, and Z.</p>
                            <p class="mb-4">We could also add more levels to the game. Currently, there is only one level.</p>
                            <p class="mb-4">We could also add a high score system to the game. Currently, there is no way to keep
                                track of the player's score.</p>
                            <p class="mb-4">We could also consider adding a multiplayer mode to the game. This would allow players
                                to compete against each other in real-time, adding a new level of challenge and excitement to the
                                game.</p>
                            <p class="mb-4">We could also consider adding custom themes to the game. This would allow players to
                                personalize their gaming experience and make the game more visually appealing.</p>
                
                            <h2 class="text-2xl font-bold mb-4">Rubik's Cube Version</h2>
                            <p class="mb-4">Coming soon...</p>
                            <h2 class="text-2xl font-bold mb-4">🎉 Vote for the Next Tutorial!</h2>
                            <p class="mb-4">We value your opinion! Please vote for the next game you'd like to see in our series:</p>
                            <form>
                                <input type="radio" id="game1" name="game" value="game1">
                                <label for="game1">Space Invaders with p5.js and ChatGPT</label><br>
                                <input type="radio" id="game2" name="game" value="game2">
                                <label for="game2">Pacman with p5.js and ChatGPT</label><br>
                                <input type="radio" id="game3" name="game" value="game3">
                                <label for="game3">Snake with p5.js and ChatGPT</label><br>
                                <input type="submit" value="Submit">
                            </form>
                        </div>
                        <button onclick="this.parentElement.parentElement.previousElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-left">Prev</button>
                        <!-- <button
                            onclick="this.parentElement.parentElement.nextElementSibling.scrollIntoView({behavior: 'smooth'});"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold p-4 m-4 rounded float-right">Next</button> -->
                    </div>
                </div> <!-- end div#future.content -->

                <div id="credits" class="content-viewer col-span-4 text-center w-full credits bg-midnightblue text-palegoldenrod p-4 border-gray-300 border-radius rounded-lg m-4">
                    <p class=" text-center w-full block relative">Find this content useful? <a href="https://www.ko-fi.com/jakedowns" target="_newtab" class="text-center w-full block relative">
                        <img src="https://ko-fi.com/img/githubbutton_sm.svg" class="inline-block" alt="Buy Me a Coffee at ko-fi.com" /></a></p>

                    <p class="mt-4">
                    by <a href="https://patreon.com/jakedowns" target="_newtab">jake downs</a> and chatgpt. <a
                        href="https://github.com/jakedowns/starpages" target="_newtab">Fork this project on Github!</a> | <a
                        href="https://github.com/jakedowns/starpages/blob/main/tetris-with-p5js-and-chatgpt-tutorial.html"
                        target="_newtab">View Source Code</a>
                    </p>
                        
                    </a>
                </div>
            </div>
        </div>    
    </div>

    <div id="copyAlert" class="fixed top-0 right-0 bg-green-500 text-white p-2 rounded hidden">Copied to clipboard ✅</div>


<script>        
        const featureRaw = `Feature: Tetris Game Loop
  In order to play Tetris
  As a player
  I want the game to update and display the game state and respond to user inputs

  Scenario: Updating the Game State
    Given the game is in progress
    When a frame updates
    Then the position of the Tetromino should be updated
    And check for collision with other Tetrominos or boundaries
    And clear lines if they are complete

  Scenario: Drawing the Game State
    Given the game is in progress
    When a frame updates
    Then the current Tetromino should be drawn in its position
    And the game grid with placed Tetrominos should be displayed
    And the game information like score and level should be shown

  Scenario: Handling User Input for Movement and Rotation
    Given the game is in progress
    When the user presses a movement key
    Then the Tetromino should move in the corresponding direction
    When the user presses a rotation key
    Then the Tetromino should rotate accordingly

  Scenario: Handling Other User Inputs
    Given the game is in progress
    When the user presses a special control key like pause
    Then the corresponding game action should be executed

  Scenario: Initializing the Game State
    Given the game is starting
    Then initialize the game grid and the initial Tetromino
    And set up any other necessary starting conditions
`;        
function resetGrid() {
                                    document.getElementById('rows').value = 20;
                                    document.getElementById('columns').value = 10;
                                    updateGrid();
                                }
const bgImages = {
                    'intro': '/res/DALL%C2%B7E%202023-12-26%2015.57.30%20-%20A%20visually%20compelling%20blog%20header%20image,%20designed%20in%20dark%20mode,%20that%20encapsulates%20the%20themes%20of%20artificial%20intelligence,%20programming,%20and%20Tetris,%20with.png',
                    'terms': './res/9800c48a-6a59-4caa-adbc-864eec10b6de.webp',
                    'building': './res/6a6cf0d2-7a1b-4cbd-b6ec-004aa01fb20b.webp',
                    'controls': './res/DALL%C2%B7E%202023-12-26%2016.45.30%20-%20Create%20a%20pixel%20art%20image%20showing%20a%20dynamic%20scene%20of%20game%20development,%20where%20workers%20handle%20keyboard%20and%20touch%20inputs,%20including%20giant%20finger%20and%20keybo.png',
                    'mobile': './res/DALL%C2%B7E%202023-12-26%2019.21.19%20-%20Create%20a%20pixel%20art%20image%20showing%20a%20dynamic%20scene%20of%20game%20development,%20where%20workers%20handle%20keyboard%20and%20touch%20inputs,%20including%20giant%20finger%20and%20keybo.png',
                    'tetrominos': './res/9f57e694-d11b-4721-9076-10a647235738.webp',
                    'game': './res/3d6e5e06-df51-4ef2-8b0e-1985ff458716.webp',
                    'future': './res/DALL%C2%B7E%202023-12-26%2016.44.44%20-%20Create%20a%20large,%20detailed%20mega%20pixel%20art%20image%20depicting%20a%20scene%20where%20workers%20are%20handling%20keyboard%20and%20touch%20inputs%20and%20processing%20them%20in%20a%20queue%20of.png'
                };
                document.querySelectorAll('.content-viewer, .menu-section').forEach((element) => {
                    element.addEventListener('mouseenter', (event) => {
                        let bgImage = bgImages[event.target.id.split('nav-').join('')];
                        console.warn("bgImage", { bgImage, id: event.target.id })
                        let targetElement = event.target;

                        while (!bgImage && targetElement.parentElement) {
                            targetElement = targetElement.parentElement;
                            bgImage = bgImages[targetElement.id || targetElement.dataset.sectionKey];
                        }

                        if (bgImage) {
                            document.getElementsByClassName('bg-img')[0].classList.remove('swap');
                            document.documentElement.style.setProperty('--bg-image-out', `url(${document.documentElement.style.getPropertyValue('--bg-image-in')})`);
                            document.documentElement.style.setProperty('--bg-image-in', `url(${bgImage})`);
                            document.getElementsByClassName('bg-img')[0].classList.add('swap');
                            if(window.swapTimer){
                                clearTimeout(window.swapTimer);
                            }
                            window.swapTimer = setTimeout(() => {
                                document.getElementsByClassName('bg-img')[0].classList.remove('swap');
                            }, 1);
                        } else {
                            console.error("No bgImage found for", { id: event.target.id })
                        }
                    });
                });

                document.querySelectorAll('.menu-sections, .content-viewer').forEach((element) => {
                    element.addEventListener('mouseout', (event) => {
                        // make sure we ACTUALLY moused OUT of the target not into a child
                        if (event.relatedTarget && event.target.contains(event.relatedTarget)) {
                            return;
                        }
                        if (event.target.classList.contains('menu-section')) {
                            //document.querySelector('.bg-img').classList.remove('swap');
                        }
                    });
                });
        
    function updateGrid() {
        const rows = document.getElementById('rows').value;
        const columns = document.getElementById('columns').value;
        const prompt = `Given a grid of ${rows} rows and ${columns} columns, we will initialize a 2D array to represent our grid. Each cell in the array will represent a cell in the Tetris grid. All cells will be empty at the start of the game. We will use p5.js to create a function to draw the grid on the screen. This function will loop through each cell in our 2D array and draw a square at the corresponding location on the screen. We will also create a function to update the grid. This function will be called whenever a Tetris block is moved or rotated. It will update the 2D array to reflect the new state of the grid.`;
        document.getElementById('promptOutput-building').textContent = prompt;
    }
    window.updateTetrominoPrompt = function () {
        const prompt = `Given 7 Tetrominos (I, J, L, O, S, T, and Z), we will initialize a 2D array to represent each Tetromino. Each cell in the array will represent a block in the Tetromino. We will use p5.js to create a function to draw a Tetromino on the screen. This function will loop through each cell in the Tetromino's 2D array and draw a square at the corresponding location on the screen. We will also create a function to update the position and rotation of a Tetromino. This function will be called whenever a Tetromino is moved or rotated. It will update the 2D array to reflect the new state of the Tetromino.`;
        document.getElementById('promptOutput-tetrominos').textContent = prompt;
    };
    function copyToClipboard(key) {
        const prompt = document.getElementById(`promptOutput-${key}`).textContent;
        console.warn('copied', prompt)
        navigator.clipboard.writeText(prompt);
        showCopyAlert();
    }
    function showCopyAlert() {
        const copyAlert = document.getElementById('copyAlert');
        copyAlert.classList.remove('hidden');
        setTimeout(() => {
            copyAlert.classList.add('hidden');
        }, 1000);
    }
    let contentViewerList,
        timelineCovered, totalHeight, totalSections;
    const onScroll = function () {

        const sections = document.querySelectorAll('.content');
        const navSections = document.querySelectorAll('.menu-section');
        let closest = null;
        let closestTop = Infinity;
        let visitedIndex = 0;

        sections.forEach((section, index) => {
            const rect = section.getBoundingClientRect();
            const parentRect = contentViewerList.getBoundingClientRect();
            const relativeTop = rect.top - parentRect.top;
            const bottomEdgeInViewPort = rect.bottom - 100 >= parentRect.top;
            const topEdgeCloseToViewportTop = relativeTop >= 0 && relativeTop < 30;

            if (bottomEdgeInViewPort || topEdgeCloseToViewportTop) {
                if (relativeTop < closestTop) {
                    closest = navSections[index];
                    closestTop = relativeTop;
                    visitedIndex = index;
                }
            }
        });

        if (closest) {
            navSections.forEach(section => {
                section.classList.remove('active-section');
            });
            closest.classList.add('active-section');

            // Add visited class to the corresponding timeline circle
            const timelineCircles = document.querySelectorAll('.timeline-circle');
            timelineCircles.forEach((circle, index) => {
                if (index <= visitedIndex) {
                    circle.classList.add('visited');
                } else {
                    circle.classList.remove('visited');
                }
            });

            // Update the height of timeline_covered
            const progress = (visitedIndex+1) / (totalSections);
            const oneSection = totalHeight / totalSections;
            
            timelineCovered.style.height = `${Math.min(progress * 100, 100)}%`;

            console.warn('%',{
                progress,
                visitedIndex,
                totalSections,
                totalHeight,
                scrollTop: contentViewerList.scrollTop,
                clientHeight: contentViewerList.clientHeight,
                scrollBottom: contentViewerList.scrollTop + contentViewerList.clientHeight,
                scrollHeight: contentViewerList.scrollHeight,
            })

            // If we've visited the last section, set the height to 100%
            // if (contentViewerList.scrollTop + contentViewerList.clientHeight >= totalHeight) {
            //     timelineCovered.style.height = '100%';
            // }
        }
    }
    const setup2 = function () {
        document.addEventListener('click',(e)=>{
            // if we clicked on or in a ".content-viewer" element
            // toggle the css-var "--max-columns" between 4 and 1
            // toggle body class .force-to-one-col
            if (e.target.closest('.content-viewer')) {

                const ignoredElements = ['button', 'input', 'textarea', 'pre', 'code', 'a', 'p', 'span'];
                if(ignoredElements.some(element => e.target.closest(element))){
                    // ignore clicks on buttons, inputs, textareas, code blocks, and links
                    return;
                }
                const ignoredClassnames = ['clickable','copyButton'];
                if(ignoredClassnames.some(className => e.target.closest(`.${className}`))){
                    // ignore clicks on elements with the "clickable" class
                    return;
                }

                const maxColumns = getComputedStyle(document.documentElement).getPropertyValue('--max-columns');
                document.documentElement.style.setProperty('--max-columns', maxColumns === '4' ? '1' : '4');
                document.body.classList.toggle('force-to-one-col');

                // scroll to that element
                e.target.closest('.content-viewer').scrollIntoView({behavior: 'smooth'});
            }
        })

        contentViewerList = document.getElementsByClassName('content-viewer-outer')[0];
        timelineCovered = document.querySelector('.timeline_covered');
        totalHeight = contentViewerList.scrollHeight;
        totalSections = document.querySelectorAll('.menu-section').length;
        // This script is responsible for highlighting the section's #anchor box top closest to the current scroll y offset
        // It listens for the 'scroll' event on the 'contentViewerList' element
        // On each 'scroll' event, it calculates which section is closest to the top of the 'contentViewerList'
        // It then removes the 'active-section' class from all sections and adds it to the closest section
        // This gives the effect of the closest section being highlighted as the user scrolls through the content
        // If the highlighting is not working as expected, there could be a few potential issues:
        // 1. The 'scroll' event is not being fired. This could be due to the 'contentViewerList' not being scrollable, or the event listener not being added correctly.
        // 2. The calculations for determining the closest section are incorrect. This could be due to incorrect use of the getBoundingClientRect() method, or issues with the parentRect and relativeTop calculations.
        // 3. The 'active-section' class is not being added or removed correctly. This could be due to a typo in the class name, or issues with the classList.add() and classList.remove() methods.
        // To fix these issues, ensure that the 'scroll' event is being fired, the calculations are correct, and the 'active-section' class is being added and removed correctly.


        contentViewerList.addEventListener('scroll', onScroll);
    }

        window.onload = () => {
            updateGrid();
            updateTetrominoPrompt();
            setup2();
            onScroll();

            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0 }
            });
        }
    
        // JavaScript for showing and hiding content
        function showContent(id) {
            const content = document.getElementById(id);
            //content.classList.remove('hidden');
            // show content in .content-viewer elements
            // document.querySelectorAll('.content-viewer').forEach(viewer => {
            //   viewer.innerHTML = content.innerHTML;
            // });
        }

        function hideContent(id) {
            const content = document.getElementById(id);
            //content.classList.add('hidden');
            // clear .content-viewer
        }

        // select the first section by default
        document.addEventListener('DOMContentLoaded', () => {
            showContent('building');
        });

        function scrollToSection(direction) {
            const contentViewerList = document.getElementsByClassName('content-viewer-outer')[0];
            const contentSections = Array.from(document.querySelectorAll('.content-viewer'));
            const currentScrollTop = contentViewerList.scrollTop;
            const currentClientHeight = contentViewerList.clientHeight;
            let nextSection = null;

            // Find the section that takes up the most of the viewport
            let maxSection = null;
            let maxSectionCoverage = 0;

            for (let i = 0; i < contentSections.length; i++) {
                const section = contentSections[i];
                const sectionTop = Math.max(section.getBoundingClientRect().top, 0);
                const sectionBottom = Math.min(section.getBoundingClientRect().bottom, window.innerHeight);
                const sectionCoverage = sectionBottom - sectionTop;

                if (sectionCoverage > maxSectionCoverage) {
                    maxSection = section;
                    maxSectionCoverage = sectionCoverage;
                }
            }

            // Find the next or previous section relative to the current section
            const currentIndex = contentSections.indexOf(maxSection);
            if (direction === 'next' && currentIndex < contentSections.length - 1) {
                nextSection = contentSections[currentIndex + 1];
            } else if (direction === 'previous' && currentIndex > 0) {
                nextSection = contentSections[currentIndex - 1];
            }

            // Scroll to the next or previous section if it exists
            if (nextSection) {
                const nextScrollTop = nextSection.offsetTop;
                contentViewerList.scrollTo({ top: nextScrollTop, behavior: 'smooth' });
            }
        }

        function scrollToNextSection() {
            scrollToSection('next');
        }

        function scrollToPreviousSection() {
            scrollToSection('previous');
        }
        // Modify switchContent and switchContentMobile functions to show and hide content
        function switchContent(section) {
            // if we're not in force-to-one-col mode, enter it now
            const maxColumns = getComputedStyle(document.documentElement).getPropertyValue('--max-columns');
            if (!document.body.classList.contains('force-to-one-col')) {
                document.documentElement.style.setProperty('--max-columns', '1');
                document.body.classList.add('force-to-one-col');
            } else {
                //document.body.classList.remove('force-to-one-col');
            }


            const contentViewerList = document.getElementsByClassName('content-viewer-outer')[0];
            const sectionElement = document.getElementById(section);
            if (!sectionElement) {
                console.error("no section element found for", section)
                return;
            }
            const top = sectionElement.offsetTop;
            contentViewerList.scrollTo({ top: top, behavior: 'smooth' });
            // if mobile menu visible, hide it
            const mobileMenu = document.getElementById('mobileMenu');
            // if (mobileMenu.classList.contains('hidden') === false) {
            //     toggleMobileMenu();
            // }
        }

        function hideAllContent() {
            hideContent('building');
            // Add more hideContent calls here for other sections
        }
    
        // JavaScript for mobile menu toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        }

        // JavaScript for content switching
        //   function switchContent(section) {
        //     const contentViewer = document.getElementById('contentViewer');
        //     contentViewer.textContent = `Content for ${section}`;
        //   }

        //   function switchContentMobile(section) {
        //     const mobileContentViewer = document.getElementById('mobileContentViewer');
        //     mobileContentViewer.textContent = `Content for ${section}`;
        //     toggleMobileMenu();
        //   }
        
    </script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.3.2"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GYK2ZMX0M9"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-GYK2ZMX0M9');
    </script>
</body>

</html>